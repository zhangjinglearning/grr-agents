/**
 * Touch-Friendly Target Sizing System
 * Optimized for mobile interactions and accessibility
 */

// Touch target size constants following platform guidelines
$touch-target-minimum: 44px !default;      // Apple/iOS minimum
$touch-target-recommended: 48px !default;  // Material Design recommendation
$touch-target-comfortable: 56px !default;  // Comfortable for complex actions
$touch-target-large: 64px !default;        // Large touch targets for accessibility

// Touch target mixins
@mixin touch-target($size: $touch-target-recommended) {
  min-height: $size;
  min-width: $size;
  
  @include touch-device {
    min-height: $size;
    min-width: $size;
  }
}

@mixin touch-target-minimum {
  @include touch-target($touch-target-minimum);
}

@mixin touch-target-comfortable {
  @include touch-target($touch-target-comfortable);
}

@mixin touch-target-large {
  @include touch-target($touch-target-large);
}

// Interactive element base styling
%touch-interactive-base {
  position: relative;
  cursor: pointer;
  user-select: none;
  -webkit-touch-callout: none;
  -webkit-tap-highlight-color: transparent;
  
  // Ensure minimum touch target size
  @include touch-target-minimum;
  
  // Improve touch responsiveness
  touch-action: manipulation;
  
  // Add subtle touch feedback
  &:active {
    transform: scale(0.98);
    transition: transform 0.1s ease;
  }
}

// Button touch styling
.btn {
  @extend %touch-interactive-base;
  
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 12px 24px;
  border: 2px solid transparent;
  border-radius: 8px;
  font-weight: 500;
  text-decoration: none;
  transition: all 0.2s ease;
  
  @include touch-device {
    padding: 14px 28px;
    min-height: $touch-target-recommended;
  }
  
  // Size variants
  &.btn-sm {
    padding: 8px 16px;
    font-size: 0.875rem;
    
    @include touch-device {
      padding: 10px 20px;
      min-height: $touch-target-minimum;
    }
  }
  
  &.btn-lg {
    @include touch-target-comfortable;
    padding: 16px 32px;
    font-size: 1.125rem;
    
    @include touch-device {
      padding: 18px 36px;
    }
  }
  
  &.btn-xl {
    @include touch-target-large;
    padding: 20px 40px;
    font-size: 1.25rem;
  }
  
  // Icon buttons
  &.btn-icon {
    @include touch-target-recommended;
    padding: 0;
    
    &.btn-sm {
      @include touch-target-minimum;
    }
    
    &.btn-lg {
      @include touch-target-comfortable;
    }
    
    &.btn-xl {
      @include touch-target-large;
    }
  }
  
  // Floating action button
  &.btn-fab {
    @include touch-target-comfortable;
    border-radius: 50%;
    padding: 0;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.12);
    
    &.btn-fab-lg {
      @include touch-target-large;
    }
  }
  
  // Disabled state
  &:disabled,
  &.disabled {
    opacity: 0.6;
    cursor: not-allowed;
    transform: none !important;
  }
}

// Form input touch styling
.form-control {
  @include touch-target-recommended;
  
  padding: 12px 16px;
  border: 2px solid #e5e7eb;
  border-radius: 8px;
  font-size: 16px; // Prevent zoom on iOS
  transition: border-color 0.2s ease, box-shadow 0.2s ease;
  
  @include touch-device {
    padding: 14px 18px;
    font-size: 16px; // Ensure no zoom on mobile
  }
  
  &:focus {
    outline: none;
    border-color: #6b46c1;
    box-shadow: 0 0 0 3px rgba(107, 70, 193, 0.1);
  }
  
  // Textarea specific styling
  &.form-textarea {
    min-height: 120px;
    resize: vertical;
    
    @include mobile-only {
      resize: none; // Disable resize on mobile
    }
  }
  
  // Select dropdown styling
  &.form-select {
    appearance: none;
    background-image: url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIiIGhlaWdodD0iOCIgdmlld0JveD0iMCAwIDEyIDgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxwYXRoIGQ9Ik0xIDFMNiA2TDExIDEiIHN0cm9rZT0iIzZCNzI4MCIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiLz4KPC9zdmc+");
    background-repeat: no-repeat;
    background-position: right 12px center;
    background-size: 12px;
    padding-right: 40px;
  }
}

// Checkbox and radio button touch styling
.form-check {
  display: flex;
  align-items: center;
  gap: 12px;
  
  .form-check-input {
    @include touch-target-minimum;
    
    width: 20px;
    height: 20px;
    margin: 0;
    cursor: pointer;
    
    @include touch-device {
      width: 24px;
      height: 24px;
    }
  }
  
  .form-check-label {
    cursor: pointer;
    user-select: none;
    flex: 1;
    padding: 12px 0; // Increase touch area
    margin: -12px 0; // Offset to maintain visual spacing
    
    @include touch-device {
      padding: 16px 0;
      margin: -16px 0;
    }
  }
}

// Link touch styling
a {
  &:not(.btn) {
    @include touch-device {
      min-height: $touch-target-minimum;
      display: inline-flex;
      align-items: center;
      
      // Add padding for better touch targets on small links
      &.touch-friendly {
        padding: 8px 0;
        margin: -8px 0;
      }
    }
  }
}

// Navigation touch styling
.nav-item {
  .nav-link {
    @include touch-target-recommended;
    
    display: flex;
    align-items: center;
    padding: 12px 20px;
    text-decoration: none;
    border-radius: 8px;
    transition: background-color 0.2s ease;
    
    @include touch-device {
      padding: 16px 24px;
    }
    
    &:active {
      background-color: rgba(0, 0, 0, 0.05);
    }
  }
}

// Card touch interactions
.card {
  &.card-interactive {
    @extend %touch-interactive-base;
    
    cursor: pointer;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
    
    &:hover:not(:active) {
      @include no-touch-device {
        transform: translateY(-2px);
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
      }
    }
    
    &:active {
      transform: scale(0.98);
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
  }
}

// Modal and overlay touch considerations
.modal {
  .modal-content {
    // Ensure adequate touch targets in modals
    .modal-header {
      .btn-close {
        @include touch-target-recommended;
        padding: 0;
        margin: -8px -8px -8px auto;
      }
    }
    
    .modal-footer {
      .btn {
        margin: 4px;
        
        @include mobile-only {
          flex: 1;
          margin: 8px 4px;
        }
      }
    }
  }
}

// Dropdown menu touch styling
.dropdown-menu {
  .dropdown-item {
    @include touch-target-recommended;
    
    padding: 12px 20px;
    cursor: pointer;
    
    @include touch-device {
      padding: 16px 24px;
    }
    
    &:active {
      background-color: rgba(0, 0, 0, 0.05);
    }
  }
}

// Tab navigation touch styling
.nav-tabs {
  .nav-link {
    @include touch-target-recommended;
    
    padding: 12px 24px;
    cursor: pointer;
    border-bottom: 3px solid transparent;
    
    @include touch-device {
      padding: 16px 28px;
    }
    
    &.active {
      border-bottom-color: #6b46c1;
    }
  }
}

// Slider/Range input touch styling
.form-range {
  height: $touch-target-minimum;
  cursor: pointer;
  background: transparent;
  
  &::-webkit-slider-thumb {
    @include touch-target-minimum;
    border-radius: 50%;
    cursor: pointer;
    -webkit-appearance: none;
    
    @include touch-device {
      width: $touch-target-recommended;
      height: $touch-target-recommended;
    }
  }
  
  &::-moz-range-thumb {
    @include touch-target-minimum;
    border-radius: 50%;
    cursor: pointer;
    border: none;
    
    @include touch-device {
      width: $touch-target-recommended;
      height: $touch-target-recommended;
    }
  }
}

// Utility classes for touch targets
.touch-target-sm {
  @include touch-target-minimum;
}

.touch-target-md {
  @include touch-target-recommended;
}

.touch-target-lg {
  @include touch-target-comfortable;
}

.touch-target-xl {
  @include touch-target-large;
}

// Accessibility enhancements for touch
@media (prefers-reduced-motion: reduce) {
  %touch-interactive-base,
  .btn,
  .card-interactive {
    &:active {
      transform: none;
    }
  }
}